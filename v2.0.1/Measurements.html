<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Measurements · Spectra documentation</title><meta name="title" content="Measurements · Spectra documentation"/><meta property="og:title" content="Measurements · Spectra documentation"/><meta property="twitter:title" content="Measurements · Spectra documentation"/><meta name="description" content="Documentation for Spectra documentation."/><meta property="og:description" content="Documentation for Spectra documentation."/><meta property="twitter:description" content="Documentation for Spectra documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Spectra documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Welcome to Spectra&#39;s documentation!</a></li><li><span class="tocitem">User manual</span><ul><li><a class="tocitem" href="PreProcessing.html">Data Processing</a></li><li class="is-active"><a class="tocitem" href="Measurements.html">Measurements</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Functions-API"><span>Functions API</span></a></li></ul></li><li><a class="tocitem" href="PeakFitting.html">Peak fitting</a></li><li><a class="tocitem" href="MachineLearning.html">Machine Learning</a></li><li><a class="tocitem" href="HelperFunctions.html">Helper Functions</a></li><li><a class="tocitem" href="Tips.html">Tips</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="examples/Baseline_examples.html">Baseline examples</a></li><li><a class="tocitem" href="examples/Full_processing.html">Processing data</a></li><li><a class="tocitem" href="examples/Raman_spectrum_fitting.html">Peak fitting the Raman spectrum of a glass</a></li><li><a class="tocitem" href="examples/Smoothing.html">Smoothing data</a></li></ul></li><li><a class="tocitem" href="References.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User manual</a></li><li class="is-active"><a href="Measurements.html">Measurements</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="Measurements.html">Measurements</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/charlesll/Spectra.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/charlesll/Spectra.jl/blob/master/docs/src/Measurements.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Measurements"><a class="docs-heading-anchor" href="#Measurements">Measurements</a><a id="Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Measurements" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Various functions to measure the parameters of peaks visible on spectra are available.</p><p>A new core function is introduced in v1.1: <a href="Measurements.html#Spectra.find_peaks"><code>find_peaks</code></a>, which leverages the <a href="https://www.juliapackages.com/p/peaks">Peaks.jl</a> package. This function allows you to, as its name says, find peaks in a signal and calculate various parameters, such as their heights, widths, centroids... The later calculation relies on the <a href="Measurements.html#Spectra.centroid"><code>centroid</code></a> function, which can be called independently.</p><p>Finally, earlier versions of Spectra had a <a href="Measurements.html#Spectra.peakmeas"><code>peakmeas</code></a> function to measure various parameters (height, width, centroid...). It works but please use <a href="Measurements.html#Spectra.find_peaks"><code>find_peaks</code></a> in your futur codes, it is much better. <a href="Measurements.html#Spectra.peakmeas"><code>peakmeas</code></a> will be removed in a future release of Spectra.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><h3 id="Example-signal"><a class="docs-heading-anchor" href="#Example-signal">Example signal</a><a id="Example-signal-1"></a><a class="docs-heading-anchor-permalink" href="#Example-signal" title="Permalink"></a></h3><p>We first generate a dummy signal to play with:</p><pre><code class="language-julia hljs">using Plots, Spectra, Random

## the x axis
x = collect(0:0.1:100)

## a fake signal: perfect y
y_perfect = gaussian(x, 1.0, 50.0, 6.0)

## we add noise: observed y
y = y_perfect + 0.05*randn(size(x,1))

plot(x, y, label=&quot;Noisy observed signal&quot;, xlabel=&quot;X&quot;, ylabel=&quot;Y&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GKS: cannot open display - headless operation mode active</code></pre><p><img src="ppm_1.svg" alt/></p><h3 id="Estimating-parameters-for-one-peak"><a class="docs-heading-anchor" href="#Estimating-parameters-for-one-peak">Estimating parameters for one peak</a><a id="Estimating-parameters-for-one-peak-1"></a><a class="docs-heading-anchor-permalink" href="#Estimating-parameters-for-one-peak" title="Permalink"></a></h3><p>For one peak, estimations can be done using <a href="Measurements.html#Spectra.peakmeas"><code>peakmeas</code></a>:</p><pre><code class="language-julia hljs">height_y, hwhm_y, position_y, centroid_y, smoothed_y = peakmeas(x,vec(y),smoothing = &quot;yes&quot;, method= &quot;savgol&quot;,  y_smo_out = true)

println(&quot;Estimated peak height is $(height_y)&quot;)
println(&quot;Estimated peak hwhm is $(hwhm_y)&quot;)
println(&quot;Estimated peak position is $(position_y)&quot;)
println(&quot;Estimated peak centroid is $(centroid_y)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Estimated peak height is 1.0664761689545041
Estimated peak hwhm is 50.1
Estimated peak position is 5.350000000000001
Estimated peak centroid is 50.47233687220993</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p><code>peakmeas</code> is basic. It does not work on multiple peaks. Prefer using <a href="Measurements.html#Spectra.find_peaks"><code>find_peaks</code></a>.</p></div></div><h3 id="Find-and-measure-multiple-peaks"><a class="docs-heading-anchor" href="#Find-and-measure-multiple-peaks">Find and measure multiple peaks</a><a id="Find-and-measure-multiple-peaks-1"></a><a class="docs-heading-anchor-permalink" href="#Find-and-measure-multiple-peaks" title="Permalink"></a></h3><p>To find and measure parameters of a peak or multiple peaks in a signal, we can use <a href="Measurements.html#Spectra.find_peaks"><code>find_peaks</code></a>:</p><pre><code class="language-julia hljs">result = find_peaks(x, y, smoothing=false, method=&quot;gcvspline&quot;, window_size = 20)
println(&quot;Peak positions: &quot;, result.peak_positions)
println(&quot;Peak heights: &quot;, result.peak_heights)
println(&quot;Peak hwhms: &quot;, result.peak_hwhms)
println(&quot;Peak centroids: &quot;, result.peak_centroids)
result.plot_peaks</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Peak positions: [2.6, 5.5, 8.5, 11.7, 14.8, 18.6, 23.4, 29.2, 33.2, 49.5, 64.0, 68.2, 71.8, 76.2, 79.7, 83.8, 86.1, 89.0, 91.2, 94.6, 96.9]
Peak heights: [0.1440268909277853, 0.1113795553807282, 0.10189981812582416, 0.08362302250661711, 0.09917250444454916, 0.11116288869448546, 0.179084391097305, 0.10524447181142588, 0.14380950441320814, 1.0872141987666435, 0.1486029976053012, 0.11159524227285515, 0.09264602951389075, 0.13566034793508186, 0.09897498947700087, 0.1299386868408395, 0.08772010863618644, 0.09163740569503541, 0.0927594747560826, 0.10690179749635267, 0.16520097457747815]
Peak hwhms: [0.10000000000000009, 0.3500000000000001, 0.20000000000000018, 0.10000000000000053, 0.10000000000000053, 0.09999999999999964, 0.09999999999999964, 0.29999999999999893, 0.09999999999999787, 5.799999999999997, 0.09999999999999787, 0.15000000000000568, 0.14999999999999858, 0.14999999999999858, 0.20000000000000284, 0.10000000000000142, 0.3999999999999986, 0.25, 0.10000000000000142, 0.14999999999999858, 0.10000000000000142]
Peak centroids: [2.6, 5.529129841873346, 8.407171240651227, 11.7, 14.8, 18.6, 23.4, 29.110680536152763, 33.2, 50.01914554911684, 64.0, 68.20226949874993, 71.81418935345862, 76.19327171862955, 79.69745205882037, 83.8, 86.15309635422614, 88.95521665848568, 91.2, 94.57960930516627, 96.9]</code></pre><p><img src="ppm_2.svg" alt/></p><p>Hum... it finds too much peaks here. We need to tweak the parameters of the <code>find_peaks</code> function.  We can increase the <code>min_height</code> value to detect only peaks above a certain threshold.  We can also smooth the signal, it will help filter the noise. Other options are possible, see the specific documentation of <a href="Measurements.html#Spectra.find_peaks"><code>find_peaks</code></a>.</p><pre><code class="language-julia hljs">result = find_peaks(x, y, smoothing=true, method=&quot;gcvspline&quot;, window_size = 20, min_height=0.2)
println(&quot;Peak positions: &quot;, result.peak_positions)
println(&quot;Peak heights: &quot;, result.peak_heights)
println(&quot;Peak hwhms: &quot;, result.peak_hwhms)
println(&quot;Peak centroids: &quot;, result.peak_centroids)
result.plot_peaks</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Peak positions: [50.1]
Peak heights: [0.9965230389928255]
Peak hwhms: [6.0]
Peak centroids: [50.01613708841698]</code></pre><p><img src="ppm_3.svg" alt/></p><p>Good! It works now better.</p><h3 id="Peak-centroid"><a class="docs-heading-anchor" href="#Peak-centroid">Peak centroid</a><a id="Peak-centroid-1"></a><a class="docs-heading-anchor-permalink" href="#Peak-centroid" title="Permalink"></a></h3><p>The centroid  of a peak or of a signal can also be measured using directly the <a href="Measurements.html#Spectra.centroid"><code>centroid</code></a> function.  It accepts x-y inputs, list of x-y spectra, or arrays of ys spectra associated to a vector of x values, see the documentation of <code>centroid</code>[@ref].</p><pre><code class="language-example hljs">centroid2 = centroid(x,y)
println(&quot;Estimated peak centroid is $(centroid2)&quot;)</code></pre><h2 id="Functions-API"><a class="docs-heading-anchor" href="#Functions-API">Functions API</a><a id="Functions-API-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Spectra.find_peaks" href="#Spectra.find_peaks"><code>Spectra.find_peaks</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_peaks(
x::Vector{Float64}, 
y::Vector{Float64};
smoothing::Bool = false,
window_size::Int = 20,
min_height::Float64 = 0., max_height::Float64 = Inf,
min_prom::Float64 = 0., max_prom::Float64 = Inf,
min_width::Float64 = 0., max_width::Float64 = Inf, relwidth::Float64 = 0.5,
kwargs...
)</code></pre><p>Identify peaks in spectral data (<code>x</code>, <code>y</code>) based on specified criteria such as height, prominence, and width. </p><p>It optionally applies smoothing to the signal before peak detection.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vector{Float64}</code>: The x-axis values (e.g., wavelengths or time points).</li><li><code>y::Vector{Float64}</code>: The y-axis values (e.g., intensities).</li><li><code>smoothing::Bool</code>: Whether to apply smoothing to the signal before peak detection. Default is <code>false</code>.</li><li><code>window_size::Int</code>: Size of the window for peak detection (in indices). Default is <code>20</code>.</li><li><code>min_height::Float64</code>: Minimum height of peaks to consider. Default is <code>0.0</code>.</li><li><code>max_height::Float64</code>: Maximum height of peaks to consider. Default is <code>100.0</code>.</li><li><code>min_prom::Float64</code>: Minimum prominence of peaks to consider. Default is <code>0.0</code>.</li><li><code>max_prom::Float64</code>: Maximum prominence of peaks to consider. Default is infinity (<code>Inf</code>).</li><li><code>min_width::Float64</code>: Minimum width of peaks to consider (in indices). Default is <code>0.0</code>.</li><li><code>max_width::Float64</code>: Maximum width of peaks to consider (in indices). Default is infinity (<code>Inf</code>).</li><li><code>relwidth::Float64</code>: Relative width parameter for peak widths. Default is <code>0.5</code>.</li><li>Additional keyword arguments (<code>kwargs...</code>) are passed to the smoothing function if smoothing is enabled.</li></ul><p><strong>Returns</strong></p><p>A named tuple containing:</p><ul><li><code>peak_positions::Vector{Float64}</code>: X positions of detected peaks.</li><li><code>peak_heights::Vector{Float64}</code>: Heights of detected peaks.</li><li><code>peak_prominences::Vector{Float64}</code>: Prominences of detected peaks.</li><li><code>peak_hwhms::Vector{Float64}</code>: Half-width at half maximum values for detected peaks.</li><li><code>peak_centroids::Vector{Float64}</code>: Centroid positions for detected peaks.</li><li>A plot object showing the detected peaks (<code>plot_peaks</code>), using the recipe from the Peaks.jl package.</li></ul><p><strong>Examples</strong></p><p><strong>Example 1: Basic peak detection</strong></p><pre><code class="language-julia hljs">x = collect(1:1.0:100)
y = gaussian(x, 1.0, 30.0, 3.0) + lorentzian(x, 1.0, 60.0, 6.0) + 0.01*randn(length(x))

result = find_peaks(x, y; smoothing=false, window_size=10, min_height=0.2)

println(&quot;Peak positions: &quot;, result.peak_positions)
println(&quot;Peak heights: &quot;, result.peak_heights)
display(result.plot_peaks)</code></pre><p><strong>Example 2: Peak detection with gcvspline smoothing</strong></p><pre><code class="language-julia hljs">x = collect(1:1.0:100)
y = gaussian(x, 1.0, 30.0, 3.0) + lorentzian(x, 1.0, 60.0, 6.0) + 0.01*randn(length(x))

result = find_peaks(x, y; smoothing=true, method=&quot;gcvspline&quot;, window_size=10, min_height=0.2)

println(&quot;Peak positions: &quot;, result.peak_positions)
println(&quot;Peak heights: &quot;, result.peak_heights)
display(result.plot_peaks)</code></pre><p><strong>Notes</strong></p><ul><li>this function is a convenient wrapper around the Peaks.jl functionalities to find peaks in a vector y. For more control, you can directly use the Peaks.jl functions, the package should be available in your environment as it is a dependency for Spectra!</li><li>for smoothing, try the <code>method = &quot;gcvspline&quot;</code> or <code>method = &quot;savgol&quot;</code> options, which are the most efficient for peak detection.</li><li>the <code>window_size</code> parameter is not in the units of <code>x</code>, but in the units of index. For example, if you have 1000 points in your x-axis and you want to detect peaks with a window of 10 points, set <code>window_size=10</code>.</li><li>the <code>min_width</code> and <code>max_width</code> parameters are also not in the units of <code>x</code>, but in the units of index. For example, if you have 1000 points in your x-axis and you want to detect peaks with a width of 10 points, set <code>min_width=10</code> and <code>max_width=10</code>.</li><li>the <code>relwidth</code> parameter is a relative width parameter for peak widths. It is used to calculate the width of the peak at a certain relative height. For example, if you set <code>relwidth=0.5</code>, it will calculate the width of the peak at half its maximum height.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/4808da7a3019453e4705a99d335e224199a60b09/src/peakmeasurement.jl#L194-L266">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Spectra.centroid" href="#Spectra.centroid"><code>Spectra.centroid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">centroid(x::Vector{Float64}, y::Vector{Float64}; smoothing::Bool = false, kwargs...)
centroid(spectrum::Matrix{Float64}; smoothing::Bool = false, kwargs...)
centroid(x::Vector{Float64}, y::Matrix{Float64}; smoothing::Bool = false, kwargs...)
centroid(spectra::Vector{&lt;:Matrix}; smoothing::Bool = false, kwargs...)</code></pre><p>Calculate the centroid of a spectrum or a set of spectra.</p><p>The function supports optional smoothing and handles various input formats, including single spectra, matrices, and lists of spectra.</p><p><strong>Methods</strong></p><ol><li><code>centroid(x::Vector{Float64}, y::Vector{Float64}; smoothing::Bool = false, kwargs...)</code> Computes the centroid for a single spectrum.</li><li><code>centroid(spectrum::Matrix{Float64}; smoothing::Bool = false, kwargs...)</code> Computes the centroid for a two-column matrix where the first column represents x values and the second column represents y values.</li><li><code>centroid(x::Vector{Float64}, y::Matrix{Float64}; smoothing::Bool = false, kwargs...)</code> Computes the centroid for multiple spectra stored as columns in a matrix.</li><li><code>centroid(spectra::Vector{&lt;:Matrix}; smoothing::Bool = false, kwargs...)</code> Computes the centroids for a list of x-y spectra.</li></ol><p><strong>Arguments</strong></p><ul><li><code>x::Vector{Float64}</code>: The x-axis values (e.g., wavelengths or time points).</li><li><code>y::Union{Vector{Float64}, Matrix{Float64}}</code>: The y-axis values (e.g., intensities), either as a single vector or multiple columns (for multiple spectra).</li><li><code>spectrum::Matrix{Float64}</code>: A two-column matrix with x values in the first column and y values in the second column.</li><li><code>spectra::Vector{&lt;:Matrix}</code>: A list of matrices, each representing an x-y spectrum.</li><li><code>smoothing::Bool</code>: Whether to apply smoothing to the y-axis values before calculating the centroid. Default is <code>false</code>.</li><li><code>kwargs...</code>: Additional keyword arguments passed to the smoothing function if smoothing is enabled.</li></ul><p><strong>Returns</strong></p><ul><li>For single spectrum (<code>x</code>, <code>y</code>): A scalar value representing the centroid position.</li><li>For multiple spectra (<code>x</code>, <code>y</code> as matrix): A vector where each element is the centroid of a corresponding column in <code>y</code>.</li><li>For two-column spectrum (<code>spectrum</code>): A scalar value representing the centroid position.</li><li>For list of spectra (<code>spectra</code>): A vector where each element is the centroid of a corresponding spectrum in the list.</li></ul><p><strong>Examples</strong></p><p><strong>Example 1: Centroid of a single spectrum</strong></p><pre><code class="language-julia hljs">x = collect(0.:1.:100.)
y_peak = gaussian(x, 1., 50., 10.)
centroid_peak = centroid(x, y_peak)</code></pre><p><strong>Example 2: Centroid of a single spectrum with smoothing</strong></p><pre><code class="language-julia hljs">x = collect(0.:1.:100.)
y_peak = gaussian(x, 1., 50., 10.)
centroid_peak = centroid(x, y_peak, smoothing=true, method=&quot;gcvspline&quot;)</code></pre><p><strong>Example 3: Centroid of a single spectrum as an array</strong></p><pre><code class="language-julia hljs">my_spectrum = [x y_peak]
centroid_peak = centroid(my_spectrum)</code></pre><p><strong>Example 4: Centroids of an array of y spectra</strong></p><pre><code class="language-julia hljs">ys = [y_peak y_peak y_peak y_peak]
centroid_peaks = centroid(x, ys)</code></pre><p><strong>Example 5: Centroids of a vector of x-y spectra</strong></p><pre><code class="language-julia hljs">vector_spectra = [[x y_peak], [x y_peak], [x y_peak]]
centroid_peaks = centroid(vector_spectra)</code></pre><p><strong>Notes</strong></p><ul><li>The optional smoothing operation uses an external function (<code>smooth</code>) and accepts additional parameters via <code>kwargs...</code>.</li><li>Ensure that input dimensions are consistent (e.g., matching lengths for <code>x</code> and <code>y</code>, or proper formatting for matrices).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/4808da7a3019453e4705a99d335e224199a60b09/src/peakmeasurement.jl#L106-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Spectra.peakmeas" href="#Spectra.peakmeas"><code>Spectra.peakmeas</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">peakmeas(x::Array{Float64,1}, y::Array{Float64,1}; smoothing::Bool = true, method::String = &quot;savgol&quot;, window_length::Int=5, polyorder::Int=2, ese_y::Float64=1., y_smo_out::Bool=false)</code></pre><p>Perform measurements of the position, width, intensity and centroid of a dominant peak in a provided <code>x</code>-<code>y</code> signal.</p><p>It smooths the signal with a Savitzky-Golay filter prior to measuring the peak position,  width and intensity. It is advised to check that the M and N values of the Savitzky-Golay  filter are adequate for your problem before trusting the results from peakmeas. For that, set <code>y_smo_out=true</code>.</p><p>Half-width at half-maximum are calculated as the width of the peak at half its maximum intensity. This calculation is not affected by any asumption of peak symmetry (no fitting is done).</p><p>Centroïd is calculated as sum(y./sum(y).*x).</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function may not stay in future versions. Consider using <code>find_peaks</code> instead.</p></div></div><p><strong>Inputs</strong></p><p>-<code>x::Array{Float64}</code>: the x values -<code>y::Array{Float64}</code>: the y values</p><p><strong>Options</strong></p><p>-<code>smoothing::String</code>: triggers the smoothing of the spectrum if set to yes (default value); -<code>filter::Symbol</code>: the filter that will be used. See the smooth function documentation; -<code>M::Int</code>: M parameter for smoothing y with a Savitzky-Golay filter. See smooth function documentation. Default = 5. -<code>N::Int</code>: N parameter for smoothing y with a Savitzky-Golay filter. See smooth function documentation. Default = 2.  -<code>y_smo_out::bool</code>: Outputs the smoothed signal.</p><p><strong>Outputs</strong></p><p>-<code>intensity::Float64</code>: peak intensity -<code>position::Float64</code>: peak position -<code>hwhm: Float6:: peak</code> half-width at half-maximum -<code>centroïd::Float64</code>: peak centroid</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/4808da7a3019453e4705a99d335e224199a60b09/src/peakmeasurement.jl#L17-L51">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="PreProcessing.html">« Data Processing</a><a class="docs-footer-nextpage" href="PeakFitting.html">Peak fitting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 24 April 2025 22:13">Thursday 24 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
